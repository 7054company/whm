function initStripeACH(){var e=jQuery("#frmPayment");if(e.length){jQuery("#inputBankAcctType").closest("div.form-group").slideUp().remove(),jQuery("#inputBankAcctHolderName").closest("div.form-group").slideUp().remove(),jQuery("#inputBankRoutingNum").closest("div.form-group").slideUp().remove(),jQuery("#inputBankName").closest("div.form-group").slideUp().remove(),jQuery("#inputBankAcctNum").closest("div.form-group").slideUp().remove(),jQuery("#billingAddressChoice").closest("div.form-group").slideUp().remove();var n=jQuery("#btnSubmitContainer"),t=jQuery('input[name="paymethod"]:checked').val();e.off("submit"),n.find("button").addClass("disabled").prop("disabled",!0),n.before('<div class="form-group bank-details">\n    <label for="inputBankDetails" class="col-sm-4 control-label">\n        \n    </label>\n    <div class="col-sm-6">\n        <button type="button" class="btn btn-default form-control" id="inputBankDetails">            <i class="fal fa-plus-circle"></i> Add Bank Information        </button>    </div>\n</div>');var i="#inputBankDetails",o=jQuery(i);"new"===t?(o.not(":visible")&&o.show("fast"),jQuery(document).on("click",i,handler_open)):(o.is(":visible")&&o.hide("fast"),jQuery(document).off("click",i),n.find("button").removeClass("disabled").prop("disabled",!1)),jQuery('input[name="paymethod"]').on("ifChecked",function(){o=jQuery("#inputBankDetails"),"new"===jQuery(this).val()?(o.not(":visible")&&o.show("fast"),jQuery(document).on("click",i,handler_open)):(o.is(":visible")&&o.hide("fast"),jQuery(document).on("click",i,handler_open),n.find("button").removeClass("disabled").prop("disabled",!1))})}}function stripe_ach_reset_input_to_new(){jQuery('input[name="paymethod"][value="new"]').iCheck("check"),setTimeout(function(){jQuery(".gateway-errors").hide().addClass("hidden")},4e3)}function handler_open(){var e=jQuery("#frmPayment"),n=jQuery(".gateway-errors").first(),t=Plaid.create({env:plaidEnvironment,clientName:companyName,key:plaidPublicKey,product:["auth"],selectAccount:!0,onSuccess:function(t,i){WHMCS.http.jqClient.jsonPost({url:WHMCS.utils.getRouteUrl("/stripe_ach/token/exchange"),data:{token:csrfToken,public_token:t,account_id:i.account_id},success:function(n){token=n.token,e.append(jQuery('<input type="hidden" name="remoteStorageToken">').val(token));var t=jQuery("#btnSubmitContainer"),i=jQuery("#inputBankDetails");i.prop("disabled",!0).addClass("disabled"),t.find("button").removeClass("disabled").prop("disabled",!1),t.find("button").click(),t.find("button").addClass("disabled").prop("disabled",!0)},warning:function(e){n.html(e),n.hasClass("hidden")&&n.removeClass("hidden").show(),scrollToGatewayInputError()},fail:function(e){n.html(e),n.hasClass("hidden")&&n.removeClass("hidden").show(),scrollToGatewayInputError()}})},onExit:function(e,t){null===e&&t&&"requires_credentials"===t.status&&!t.link_session_id&&(e="Incorrect Plaid credentials provided. Please contact support."),null!=e&&(n.html(e),n.hasClass("hidden")&&n.removeClass("hidden").show(),scrollToGatewayInputError())}});t.open()}