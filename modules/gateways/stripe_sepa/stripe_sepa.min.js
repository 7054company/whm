function initStripeSEPA(){var e=jQuery("#frmPayment");if(e.length){jQuery("#inputBankAcctType").closest("div.form-group").slideUp().remove(),jQuery("#inputBankRoutingNum").closest("div.form-group").slideUp().remove(),jQuery("#inputBankName").closest("div.form-group").slideUp().remove(),jQuery("#inputBankAcctNum").closest("div.form-group").slideUp().remove(),jQuery("#billingAddressChoice").closest("div.form-group").slideUp().remove(),jQuery("#inputDescriptionContainer").before('<div id="ibanElementContainer" class="form-group bank-details">\n    <label for="ibanElement" class="col-sm-4 control-label">\n'+lang.iban+'    </label>\n<div class="col-sm-7">    <div class="input-inline form-control" id="ibanElement">\n</div>    </div>\n</div><div id="mandateAcceptanceContainer" class="form-group bank-details">\n    <div class="alert alert-info" id="mandateAcceptance">\n'+lang.mandate_acceptance+"    </div>\n</div>");var i=jQuery('input[name="paymethod"]:checked').val(),s=jQuery("#ibanElementContainer"),a=jQuery("#mandateAcceptanceContainer"),n=jQuery("#inputBankAcctHolderName").closest("div.form-group");iban.mount("#ibanElement"),e.off("submit"),iban.off("change"),"new"===i?(s.not(":visible")&&(s.show("fast"),iban.on("change",stripe_sepa_iban_change_event),e.on("submit.stripe_sepa",stripe_sepa_form_submit)),a.not(":visible")&&a.show("fast"),n.hasClass("hidden")&&n.hide().removeClass("hidden"),n.not(":visible")&&n.show("fast")):(s.is(":visible")&&s.hide("fast"),a.is(":visible")&&a.hide("fast"),n.is(":visible")&&n.hide("fast")),jQuery('input[name="paymethod"]').on("ifChecked",function(){s=jQuery("#ibanElementContainer"),a=jQuery("#mandateAcceptanceContainer"),n=jQuery("#inputBankAcctHolderName").closest("div.form-group"),"new"===jQuery(this).val()?(s.not(":visible")&&(s.show("fast"),iban.on("change",stripe_sepa_iban_change_event),e.on("submit.stripe_sepa",stripe_sepa_form_submit)),a.not(":visible")&&a.show("fast"),n.hasClass("hidden")&&n.hide().removeClass("hidden"),n.not(":visible")&&n.show("fast")):(s.is(":visible")&&(s.hide("fast"),iban.off("change"),e.off("submit.stripe_sepa")),a.is(":visible")&&a.hide("fast"),n.is(":visible")&&n.hide("fast"))})}}function stripe_sepa_iban_change_event(e){var i=jQuery(".gateway-errors").first(),s=i.closest("form");e.error&&e.error.message.length?(i.html(e.error.message),i.hasClass("hidden")&&i.removeClass("hidden").show(),s.find('button[type="submit"]').prop("disabled",!1).removeClass("disabled").find("span").toggleClass("hidden"),scrollToGatewayInputError()):i.hasClass("hidden")||i.hide().addClass("hidden")}function stripe_sepa_form_submit(e){var i=jQuery("#btnSubmit").addClass("disabled").prop("disabled",!0);e.preventDefault();var s={type:"sepa_debit",currency:"eur",owner:{name:jQuery("#inputBankAcctHolderName").val(),email:clientEmail},mandate:{notification_method:"email"}};stripe.createSource(iban,s).then(function(e){var s=jQuery(".gateway-errors").first();e.error&&e.error.message.length?(s.html(e.error.message),s.hasClass("hidden")&&(s.removeClass("hidden").show(),i.removeClass("disabled").prop("disabled",!1))):(s.addClass("hidden"),stripeSourceHandler(e.source))})}function stripeSourceHandler(e){var i=document.getElementById("frmPayment"),s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name","remoteStorageToken"),s.setAttribute("value",e.id),i.appendChild(s),i.submit()}